#!/usr/bin/python3

def can_unlock_all(boxes):
    # Set to store keys
    keys = set()
    # Add the keys in the first box to the set
    keys.update(boxes[0])

    # Iterate through the boxes
    for i in range(len(boxes)):
        # If the current box is not locked (i.e. has a key in the set)
        if i in keys:
            # Add the keys in the current box to the set
            keys.update(boxes[i])
    # Return True if the set contains keys for all boxes, else False
    return len(keys) == len(boxes)
